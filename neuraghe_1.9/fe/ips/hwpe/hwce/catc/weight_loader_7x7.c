#include <stdint.h>

#define NUM_WEIGHT 50 

// 9x9 masks
static uint16_t mask_9x9_0 [50] = {
  0, 0, 1, 1, 1, 1, 1,
  0, 0, 1, 1, 1, 1, 1,
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  0
};
static uint16_t mask_9x9_1 [50] = {
  1, 1, 1, 1, 1, 0, 0,
  1, 1, 1, 1, 1, 0, 0,
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  0
};
static uint16_t mask_9x9_2 [50] = {
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  1, 1, 2, 2, 2, 2, 2,
  0, 0, 1, 1, 1, 1, 1,
  0, 0, 1, 1, 1, 1, 1,
  0
};
static uint16_t mask_9x9_3 [50] = {
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  2, 2, 2, 2, 2, 1, 1,
  1, 1, 1, 1, 1, 0, 0,
  1, 1, 1, 1, 1, 0, 0,
  0
};

// 11x11 masks
static uint16_t mask_11x11_0 [50] = {
  0, 0, 0, 0, 1, 1, 1,
  0, 0, 0, 0, 1, 1, 1,
  0, 0, 0, 0, 1, 1, 1,
  0, 0, 0, 0, 1, 1, 1,
  1, 1, 1, 1, 2, 2, 2,
  1, 1, 1, 1, 2, 2, 2,
  1, 1, 1, 1, 2, 2, 2,
  0
};
static uint16_t mask_11x11_1 [50] = {
  1, 1, 1, 0, 0, 0, 0,
  1, 1, 1, 0, 0, 0, 0,
  1, 1, 1, 0, 0, 0, 0,
  1, 1, 1, 0, 0, 0, 0,
  2, 2, 2, 1, 1, 1, 1,
  2, 2, 2, 1, 1, 1, 1,
  2, 2, 2, 1, 1, 1, 1,
  0
};
static uint16_t mask_11x11_2 [50] = {
  1, 1, 1, 1, 2, 2, 2,
  1, 1, 1, 1, 2, 2, 2,
  1, 1, 1, 1, 2, 2, 2,
  0, 0, 0, 0, 1, 1, 1,
  0, 0, 0, 0, 1, 1, 1,
  0, 0, 0, 0, 1, 1, 1,
  0, 0, 0, 0, 1, 1, 1,
  0
};
static uint16_t mask_11x11_3 [50] = {
  2, 2, 2, 1, 1, 1, 1,
  2, 2, 2, 1, 1, 1, 1,
  2, 2, 2, 1, 1, 1, 1,
  1, 1, 1, 0, 0, 0, 0,
  1, 1, 1, 0, 0, 0, 0,
  1, 1, 1, 0, 0, 0, 0,
  1, 1, 1, 0, 0, 0, 0,
  0
};

void weight_loader_7x7(uint32_t weight_tcdm[50/2+1], uint16_t weight_priv[50], int size, int mask) {
  for(int i=0; i<50/2; i++) {
    weight_priv[i*2]   = ((uint16_t) ((weight_tcdm[i] & 0xffff0000) >> 16) ) >> ( (size<=7) ? 0 :
      (size==9)  ? ( (mask==0) ? mask_9x9_0[i*2]     : (mask==1) ? mask_9x9_1[i*2]     : (mask==2) ? mask_9x9_2[i*2]     : mask_9x9_3[i*2]    ) :
      ( (mask==0) ? mask_11x11_0[i*2]   : (mask==1) ? mask_11x11_1[i*2]   : (mask==2) ? mask_11x11_2[i*2]   : mask_11x11_3[i*2]  ) );
    weight_priv[i*2+1] = ((uint16_t) (weight_tcdm[i] & 0x0000ffff)         ) >> ( (size<=7) ? 0 :
      (size==9)  ? ( (mask==0) ? mask_9x9_0[i*2+1]   : (mask==1) ? mask_9x9_1[i*2+1]   : (mask==2) ? mask_9x9_2[i*2+1]   : mask_9x9_3[i*2+1]  ) :
      ( (mask==0) ? mask_11x11_0[i*2+1] : (mask==1) ? mask_11x11_1[i*2+1] : (mask==2) ? mask_11x11_2[i*2+1] : mask_11x11_3[i*2+1]) );
  }
  weight_tcdm[50/2] = 1;
  return;
}
